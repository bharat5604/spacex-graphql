import { useQuery } from "@tanstack/react-query";
import { gql } from "graphql-request";
import { GraphQLResponse } from "graphql-request/dist/types";
import Head from "next/head";
import Image from "next/image";
import { FC } from "react";

import graphqlRequestClient from "../src/lib/GraphqlRequestClient";
import { SpaceXPast } from "../src/lib/interfaces/SpaceXPast";

const GET_ALL_LAUNCHES = gql`
  query {
    launchesPast(limit: 10) {
      mission_name
      launch_date_local
      launch_site {
        site_name_long
      }
      links {
        article_link
        video_link
      }
      rocket {
        rocket_name
        first_stage {
          cores {
            flight
            core {
              reuse_count
              status
            }
          }
        }
        second_stage {
          payloads {
            payload_type
            payload_mass_kg
            payload_mass_lbs
          }
        }
      }
      ships {
        name
        home_port
        image
      }
    }
  }
`;

const Home: FC = () => {
  const { isLoading, error, data } = useQuery<
    GraphQLResponse,
    Error,
    SpaceXPast[]
  >(["launches"], async () => {
    return graphqlRequestClient.request(GET_ALL_LAUNCHES);
  });

  console.log("data", data);

  return (
    <div className="">
      <Head>
        <title>SpaceX</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div className="px-8 py-6 bg-black min-h-screen">
        <h3 className="text-4xl text-center text-gray-700 font-bold">SpaceX</h3>
      </div>
    </div>
  );
};

export default Home;
